# [weak], [unowned] 나만의 예로 파헤치기



오늘은 항상 저를 햇갈리게 만들어왔던 weak와 unowned라는 녀석에 대해 정리해보는 시간입니다!

클로저 캡처링.. 순환참조.. 등 에서 심심치 않게(?) 볼 수 있는 녀석들인데 다른 블로그를 보고 이해하는데 오래 걸렸어서 나만의 생활 예시로 한번 정리해보려고함 ..ㅇㅇ



공통점으로는 둘 다 순환참조를 방지하기 위한 방법인데 미묘한 차이가 있다.

**weak** 는 참조하는 프로퍼티의 retain count를 증가시키지 않으며 기본적으로 옵셔널이며 참조하는 프로퍼티의 메모리가 해제되면 해당 프로퍼티는 nil로 할당 됩니다. 따라서 weak 프로퍼티의 메모리 관리는 해당 클래스에서 불가하며 다른 클래스에서만 가능하게 됩니다.



**unowned** 또한 참조하는 프로퍼티의 retain count를 증가시키지 않지만 weak 같이 자동으로 nil로 되지는 않습니다! 왜냐하면 unowned는 옵셔널이 아니기 때문이죠 이 말은 반대로 언제나 레퍼런스를 가지고 있다는 뜻으로도 해석이 되는데용. 영어 단어 뜻대로 해당 프로퍼티의 소유권만 가지지 않는다! 라는 의미로 되겠습니다.



🧐.....

이렇게 말해 놓으니 머리는 이해하지만 가슴이 이해하지 못하는 상황..? 이 벌어지더라구요 머리속에서 둥둥 떠다니는 느낌 아니 그래서 언제 어떻게 구분해서 써야 하는디? 라면 극단적인 상황으로 예시를 들어야 조금 이해가 쉽더라구요.



자 우선 기본적으로 정석 메뉴얼은

- weak 는 참고하고자 하는 프로퍼티의 생명주기가 나의 생명주기보다 짧을 때! 주로 delegation pattern  에서
- unowned는 참고하고자 하는 프로퍼티의 새명주기가 나의 생명주기랑 주로 비슷하거나 더 길 때! 안전하게 객체를 관리하고자 할 때

가 되는데 생명주기가 나오니 또 아득하더라구요 그래서 실생활의 극단적(?) 예로 한번 구분해보고자 합니다

솔직히 개발하면서 이렇게 극단적이기만 하지 않기 때문에 어려운거 같아요... 🥺



### weak

weak는 언제 쓴다 했죠? `참고하고자 하는 프로퍼티의 생명주기가 나의 생명주기보다 짧을 때` 라고 정의 했는데 이 예에서는 `짧을 수도 있을 때`

로 조금 정정해볼께요.

그림으로 한번 볼까요 ^^?![weakunowned-01](/Users/jibook/github_io/assets/img/Swift_img/weakunowned-01.png)

짜라잔 

Person 이라는 Class 가 존재하고 그 클래슨느 사람의 간단하게 사람의 이름이랑 그 사람의 파트너 (남자친구, 혹은 여자친구 가 된다고 가정합시다)

을 저장하고 있는 클래스네요.



저의 여자친구는 제니이고 저와 제니는 partner라는 프로퍼티에 서로를 저장하고 있어요.



**추가 가정사항: 아래에서 예시를 진행하다 보니 모호하다 라는 생각이 들어 좀더 확실하게 partner라는 프로터니는 partner의 이름을 새긴 커플링 이라 가정해봅시다**



![weakunowned-02](/Users/jibook/github_io/assets/img/Swift_img/weakunowned-02.png)

이거를 코드로 보면 이렇게 되겠군요.

저랑 제니랑 오래오래 만나면 너무나 좋겠지만... 서로 사이가 안틀어지게 됐습니다.

그녀는 커플링을 버려 둔채 사라지게 되었고 저는 제니를 바라보고 있습니다.



![](/Users/jibook/github_io/assets/img/Swift_img/weakunowned-03.png)

짠 그녀는 떠난지 오래지만 저는 허공에 대고 " 내 여자친구는 제니야! " 이러고 있네요. 문제겠죠..?

샤워하면서 이 예시를 생각할 때는 정말 기가막히다 생각했는데 뭔가 정리하면서 보니까 좀 이상하긴 한데요...? ㅋㅋㅋㅋ 여하튼